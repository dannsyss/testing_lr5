# Вариант 21
1. Считайте в переменные tr_mcc_codes, tr_types, transactions и customers_gender_train из
одноимённых таблиц из папки data. В transactions считайте только первые 1000000 строк.
Соедините transactions со всеми остальными таблицами (tr_mcc_codes, tr_types,
gender_train). Причём с customers_gender_train необходимо смёрджиться с помощью left
join, а с оставшимися датафреймами – через inner (в результате соединения датафреймов
должно получиться 999584 строки). Выделите из поля tr_datetime относительный день
tr_day (первое число до точного времени). Отфильтруйте строки таким образом, чтобы
оставить только те транзакции, у которых в соответствующий относительный день tr_day
количество уникальных MCC кодов при транзакциях было больше 70 (можно
воспользоваться функцией nunique()). Сгруппируйте полученный отфильтрованный
датафрейм по MCC коду и полу, после чего, проанализировав результат, определите
женщины или мужчины относятся к gender == 1.
Пояснения:
• Для того, чтобы выделить всё, что стоит до первого пробела, можно использовать
строковые методы для датафрейма – .str.split(), например. Либо же реализовывать
логику выделения подстроки с помощью метода apply.
• Понять, какой класс к какому типу транзакций (мужские/женские) относится
можно, если поизучать типичные для мужчин/женщин категории и сравнить
средние/медианы расходов и/или приходов в них.
2. По данным полученной таблицы изобразите столбчатую диаграмму на основе нескольких
серий.
![python_LDRfOsMJHG](https://github.com/user-attachments/assets/9a32548c-c3b0-4eea-8761-01019f2c7013)
